function createMap(){function e(){m.forEach(function(e){e.setMap(null)}),m=[]}function o(){var e=document.getElementById("y").value;r.geocode({address:e},function(o,n){function a(e,n){function a(e){var o=e*Math.PI/180;return o}function l(){var t=a(e[g].geometry.location.lat()-o[0].geometry.location.lat()),n=a(e[g].geometry.location.lng()-o[0].geometry.location.lng()),l=3961,i=Math.pow(Math.sin(t/2),2)+Math.cos(a(o[0].geometry.location.lat()))*Math.cos(a(e[g].geometry.location.lat()))*Math.pow(Math.sin(n/2),2),c=2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)),r=l*c;return console.log(r),r}if(n===google.maps.places.PlacesServiceStatus.OK)for(var g=0;g<e.length;g++){t(e[g]);var i=document.getElementById("distance"),c=document.createElement("li"),r=document.createTextNode(e[g].name+" is "+l().toFixed(2)+" miles away");c.appendChild(r),i.appendChild(c)}}if(n===google.maps.GeocoderStatus.OK){var l={map:i,position:o[0].geometry.location,animation:google.maps.Animation.DROP,label:e},g=new google.maps.Marker(l);m.push(g),i.setCenter(o[0].geometry.location)}else alert("Oops it broke");var c=document.getElementById("x").value,r=new google.maps.places.PlacesService(i);r.nearbySearch({location:o[0].geometry.location,keyword:c,rankBy:google.maps.places.RankBy.DISTANCE},a)})}function t(e){var o=e.geometry.location,t={map:i,position:o,animation:google.maps.Animation.DROP},n=new google.maps.Marker(t);m.push(n),google.maps.event.addListener(n,"click",function(){s.setContent(e.name),s.open(i,this)})}function n(e){d=e.coords.latitude,p=e.coords.longitude;({lat:e.coords.latitude,lng:e.coords.longitude})}var a=document.getElementById("map"),l={lat:33.6937232,lng:-117.8055461},g={center:l,zoom:14,scrollwheel:!1},i=new google.maps.Map(a,g),c=document.getElementById("go");c.addEventListener("click",function(){e(),o()},!1);var r=new google.maps.Geocoder,s=new google.maps.InfoWindow,m=[];navigator.geolocation?navigator.geolocation.getCurrentPosition(n):(alert("You need to enable geolocation!"),location.reload(!0));var d,p,u=new google.maps.LatLngBounds(new google.maps.LatLng(-90,-180),new google.maps.LatLng(90,180)),y=document.getElementById("y");new google.maps.places.SearchBox(y,{bounds:u})}