function createMap(){function e(){m.forEach(function(e){e.setMap(null)}),m=[]}function o(){var e=document.getElementById("y").value;r.geocode({address:e},function(o,a){function n(e,a){function n(e){var o=e*Math.PI/180;return o}function l(){var t=n(e[i].geometry.location.lat()-o[0].geometry.location.lat()),a=n(e[i].geometry.location.lng()-o[0].geometry.location.lng()),l=3961,g=Math.pow(Math.sin(t/2),2)+Math.cos(n(o[0].geometry.location.lat()))*Math.cos(n(e[i].geometry.location.lat()))*Math.pow(Math.sin(a/2),2),c=2*Math.atan2(Math.sqrt(g),Math.sqrt(1-g)),r=l*c;return r}if(a===google.maps.places.PlacesServiceStatus.OK)for(var i=0;i<e.length;i++){t(e[i]);var g=document.getElementById("distance"),c=document.createElement("li"),r=document.createTextNode(e[i].name+" is "+l().toFixed(2)+" miles away");c.appendChild(r),g.appendChild(c)}}if(a===google.maps.GeocoderStatus.OK){var l={map:g,position:o[0].geometry.location,animation:google.maps.Animation.DROP,label:e},i=new google.maps.Marker(l);m.push(i),g.setCenter(o[0].geometry.location)}else alert("Oops it broke");var c=document.getElementById("x").value,r=new google.maps.places.PlacesService(g);r.nearbySearch({location:o[0].geometry.location,keyword:c,rankBy:google.maps.places.RankBy.DISTANCE},n)})}function t(e){var o=e.geometry.location,t={map:g,position:o,animation:google.maps.Animation.DROP},a=new google.maps.Marker(t);m.push(a),google.maps.event.addListener(a,"click",function(){s.setContent(e.name),s.open(g,this)})}function a(e){d=e.coords.latitude,p=e.coords.longitude;({lat:e.coords.latitude,lng:e.coords.longitude})}var n=document.getElementById("map"),l={lat:33.6937232,lng:-117.8055461},i={center:l,zoom:14,scrollwheel:!1},g=new google.maps.Map(n,i),c=document.getElementById("go");c.addEventListener("click",function(){e(),o()},!1);var r=new google.maps.Geocoder,s=new google.maps.InfoWindow,m=[];navigator.geolocation?navigator.geolocation.getCurrentPosition(a):(alert("You need to enable geolocation!"),location.reload(!0));var d,p,u=new google.maps.LatLngBounds(new google.maps.LatLng(-90,-180),new google.maps.LatLng(90,180)),y=document.getElementById("y");new google.maps.places.SearchBox(y,{bounds:u})}